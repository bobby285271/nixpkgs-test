on:
  push:
    branches:
      - main
  workflow_dispatch:
  
  
env:
  PACKAGE_ATTR: okteto
  PR_NUMBER: 209955

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: cachix/install-nix-action@v17
      - run: nix-build -A ${PACKAGE_ATTR} https://github.com/NixOS/nixpkgs/archive/pull/${PR_NUMBER}/head.tar.gz
      - continue-on-error: true
        run: nix-shell -p tree --command tree ./result -I "nixpkgs=https://github.com/NixOS/nixpkgs/archive/nixos-unstable.tar.gz"
      - continue-on-error: true
        run: ./result/bin/${PACKAGE_ATTR} --help
      - continue-on-error: true
        run: ./result/bin/${PACKAGE_ATTR} -help
      - continue-on-error: true
        run: ./result/bin/${PACKAGE_ATTR} -h
      - continue-on-error: true
        run: ./result/bin/${PACKAGE_ATTR} --version
      - continue-on-error: true
        run: ./result/bin/${PACKAGE_ATTR} version
